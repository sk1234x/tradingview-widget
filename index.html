<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TradingView Grid with Persistent State</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        .controls {
            margin-bottom: 20px;
        }

        .checkbox-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .checkbox-item {
            display: inline-block;
            white-space: nowrap;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 10px;
        }

        .tradingview-widget-container {
            position: relative;
            width: 100%;
            padding-bottom: 66.67%;
            height: 0;
        }

        .tradingview-widget-container__widget {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .fullscreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 1000;
            background: white;
        }

        .exit-fullscreen-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 10px 20px;
            background: red;
            color: white;
            border: none;
            cursor: pointer;
        }

        @media (max-width: 768px) {
            .grid-container {
                grid-template-columns: repeat(auto-fit, minmax(100%, 1fr));
            }
        }
    </style>
</head>
<body>

<h1>TradingView Grid with Persistent State</h1>

<div class="controls">
    <h3>Select Symbols to Display:</h3>
    <div class="checkbox-list">
        <label class="checkbox-item"><input type="checkbox" class="symbol-checkbox" value="MEXC:BTCUSDT.P"> MEXC:BTCUSDT.P</label>
        <label class="checkbox-item"><input type="checkbox" class="symbol-checkbox" value="MEXC:ETHUSDT.P"> MEXC:ETHUSDT.P</label>
        <label class="checkbox-item"><input type="checkbox" class="symbol-checkbox" value="MEXC:BNBUSDT.P"> MEXC:BNBUSDT.P</label>
    </div>
</div>

<div class="grid-container" id="chartGrid"></div>

<script>
    const chartGrid = document.getElementById("chartGrid");

    const globalInterval = "D"; // Default interval

    function renderCharts() {
        const symbols = ["MEXC:BTCUSDT.P", "MEXC:ETHUSDT.P", "MEXC:BNBUSDT.P"];
        chartGrid.innerHTML = ""; // Clear previous charts

        symbols.forEach(symbol => {
            const chartContainer = document.createElement("div");
            chartContainer.className = "tradingview-widget-container";

            const widgetScript = document.createElement("script");
            widgetScript.type = "text/javascript";
            widgetScript.src = "https://s3.tradingview.com/external-embedding/embed-widget-advanced-chart.js";
            widgetScript.innerHTML = JSON.stringify({
                autosize: true,
                symbol: symbol,
                interval: globalInterval,
                timezone: "Asia/Kolkata",
                theme: "light",
                locale: "en",
                allow_symbol_change: true,
            });

            const fullScreenBtn = document.createElement("button");
            fullScreenBtn.textContent = "Full Screen";
            fullScreenBtn.style.position = "absolute";
            fullScreenBtn.style.bottom = "10px";
            fullScreenBtn.style.right = "10px";
            fullScreenBtn.style.padding = "5px 10px";
            fullScreenBtn.style.zIndex = "10";
            fullScreenBtn.style.backgroundColor = "#007bff";
            fullScreenBtn.style.color = "white";
            fullScreenBtn.style.border = "none";
            fullScreenBtn.style.borderRadius = "5px";
            fullScreenBtn.style.cursor = "pointer";

            fullScreenBtn.addEventListener("click", () => enableFullScreen(chartContainer, symbol));

            chartContainer.appendChild(widgetScript);
            chartContainer.appendChild(fullScreenBtn);
            chartGrid.appendChild(chartContainer);
        });
    }

    function enableFullScreen(chartContainer, symbol) {
        const clone = chartContainer.cloneNode(true);
        clone.classList.add("fullscreen");

        const exitButton = document.createElement("button");
        exitButton.textContent = "Exit Full Screen";
        exitButton.className = "exit-fullscreen-btn";

        exitButton.addEventListener("click", () => {
            document.body.removeChild(clone);
        });

        clone.appendChild(exitButton);
        document.body.appendChild(clone);

        const widgetScript = clone.querySelector("script");
        const newWidgetScript = document.createElement("script");
        newWidgetScript.type = "text/javascript";
        newWidgetScript.src = widgetScript.src;
        newWidgetScript.innerHTML = JSON.stringify({
            autosize: true,
            symbol: symbol,
            interval: globalInterval,
            timezone: "Asia/Kolkata",
            theme: "light",
            locale: "en",
            allow_symbol_change: true,
        });

        const widgetContainer = clone.querySelector(".tradingview-widget-container");
        widgetContainer.innerHTML = ""; // Clear previous content
        widgetContainer.appendChild(newWidgetScript);
    }

    renderCharts();
</script>

</body>
</html>
